document.getElementById("passwordForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const oldPass = document.getElementById("oldPassword").value.trim();
  const newPass = document.getElementById("newPassword").value.trim();
  const confirmPass = document.getElementById("confirmPassword").value.trim();
  const message = document.getElementById("message");

  if (oldPass !== user.password) {
    message.innerHTML = "<span style='color:red;'>Old password is incorrect.</span>";
    return;
  }

  if (newPass.length < 4) {
    message.innerHTML = "<span style='color:red;'>Password should be at least 4 characters.</span>";
    return;
  }

  if (newPass !== confirmPass) {
    message.innerHTML = "<span style='color:red;'>New passwords do not match.</span>";
    return;
  }

  const index = users.findIndex(u => u.cnic === user.cnic);
  if (index !== -1) {
    users[index].password = newPass;
    localStorage.setItem("users", JSON.stringify(users));
    localStorage.setItem("loggedInUser", JSON.stringify(users[index]));
    message.innerHTML = "<span style='color:lightgreen;'>Password updated successfully âœ…</span>";
  } else {
    message.innerHTML = "<span style='color:red;'>User not found.</span>";
  }
});
