<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Reports - AlphaMed Clinical Lab</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>ðŸ“‘ View All Reports</h1>
    <nav>
      <a href="admin_dashboard.html">Dashboard</a> |
      <a href="view_reports.html">View Reports</a> |
      <a href="report.html">Generate Report</a> |
      <a href="#" id="logoutBtn">Logout</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>All Test Reports</h2>
      <table border="1" id="reportsTable">
        <thead>
          <tr>
            <th>Patient Name</th>
            <th>CNIC</th>
            <th>Phone</th>
            <th>Department</th>
            <th>Test</th>
            <th>Result</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      let patients = JSON.parse(localStorage.getItem("patients")) || [];
      let testResults = JSON.parse(localStorage.getItem("testResults")) || [];

      let tbody = document.querySelector("#reportsTable tbody");
      tbody.innerHTML = "";

      if (patients.length === 0) {
        tbody.innerHTML = "<tr><td colspan='7'>No reports found</td></tr>";
        return;
      }

      patients.forEach(patient => {
        let patientResults = testResults.filter(r => r.cnic === patient.cnic);

        if (patientResults.length === 0) {
          tbody.innerHTML += `
            <tr>
              <td>${patient.name}</td>
              <td>${patient.cnic}</td>
              <td>${patient.phone}</td>
              <td>${patient.department}</td>
              <td>${patient.test}</td>
              <td>Pending</td>
              <td>-</td>
            </tr>
          `;
        } else {
          patientResults.forEach(r => {
            tbody.innerHTML += `
              <tr>
                <td>${patient.name}</td>
                <td>${patient.cnic}</td>
                <td>${patient.phone}</td>
                <td>${patient.department}</td>
                <td>${r.test}</td>
                <td>${r.result}</td>
                <td>${r.date}</td>
              </tr>
            `;
          });
        }
      });
    });
  </script>
  <script src="script.js"></script>
</body>
</html>
