<!DOCTYPE html>
<html lang="ur">
<head>
  <meta charset="UTF-8">
  <title>Ù¹ÛŒØ³Ù¹ Ø±Ø²Ù„Ù¹ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº - AlphaMed</title>
  <style>
    body {
      background: #121212;
      color: #fff;
      font-family: sans-serif;
      padding: 40px;
      direction: rtl;
    }

    h2 {
      color: #00ffaa;
    }

    input, button {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 6px;
      background: #1e1e1e;
      color: #fff;
      margin: 5px 0;
    }

    button {
      background: #00aaff;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>ğŸ§¬ Ù¹ÛŒØ³Ù¹ Ø±Ø²Ù„Ù¹ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº</h2>

  <input type="text" id="mrn" placeholder="MRN Ù†Ù…Ø¨Ø±">
  <button onclick="loadPatient()">Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</button>

  <div id="test-area"></div>

  <script>
    function loadPatient() {
      const mrn = document.getElementById("mrn").value.trim();
      if (mrn === "") {
        alert("Ø¨Ø±Ø§Û Ú©Ø±Ù… MRN Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº");
        return;
      }

      const patients = JSON.parse(localStorage.getItem("patientList") || "[]");
      const patient = patients.find(p => p.mrn === mrn);

      if (!patient) {
        alert("Ù…Ø±ÛŒØ¶ Ù†ÛÛŒÚº Ù…Ù„Ø§");
        return;
      }

      let html = `<p><strong>Ù†Ø§Ù…:</strong> ${patient.name || patient.fullName}</p>`;
      html += `<label>Ø±Ø²Ù„Ù¹</label>
               <input type="text" id="result" placeholder="Ø±Ø²Ù„Ù¹ Ù„Ú©Ú¾ÛŒÚº" />
               <button onclick="saveResult('${mrn}')">Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>`;
      document.getElementById("test-area").innerHTML = html;
    }

    function saveResult(mrn) {
      const result = document.getElementById("result").value.trim();
      if (result === "") {
        alert("Ø±Ø²Ù„Ù¹ Ù„Ú©Ú¾ÛŒÚº");
        return;
      }

      const reports = JSON.parse(localStorage.getItem("labReports") || "[]");
      reports.push({ mrn: mrn, result: result, date: new Date().toLocaleDateString() });
      localStorage.setItem("labReports", JSON.stringify(reports));

      alert("Ø±Ø²Ù„Ù¹ Ù…Ø­ÙÙˆØ¸ ÛÙˆ Ú¯ÛŒØ§ âœ…");
      location.reload();
    }
  </script>
</body>
</html>
