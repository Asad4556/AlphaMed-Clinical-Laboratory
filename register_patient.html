<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register Patient</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="header">
    <h2>Register Patient</h2>
    <button onclick="logout()">Logout</button>
  </div>

  <div class="container">
    <div class="card">
      <h3>Enter Patient Details</h3>
      <form id="patientForm">
        <input type="text" id="name" placeholder="Patient Name" required>
        <input type="number" id="age" placeholder="Age" required>
        <input type="text" id="gender" placeholder="Gender (Male/Female)" required>
        <input type="text" id="contact" placeholder="Contact Number" required>
        <button type="submit">Save & Generate Slip</button>
      </form>
    </div>
  </div>

  <script>
    function logout() {
      localStorage.removeItem("loggedInUser");
      window.location.href = "login.html";
    }

    document.getElementById("patientForm").addEventListener("submit", function(e) {
      e.preventDefault();

      let patients = JSON.parse(localStorage.getItem("patients")) || [];

      let patient = {
        id: Date.now(),
        name: document.getElementById("name").value,
        age: document.getElementById("age").value,
        gender: document.getElementById("gender").value,
        contact: document.getElementById("contact").value,
        date: new Date().toLocaleString()
      };

      patients.push(patient);
      localStorage.setItem("patients", JSON.stringify(patients));

      // Redirect to slip page with ID
      window.location.href = `registration-slip.html?id=${patient.id}`;
    });

    // âœ… Access control
    document.addEventListener("DOMContentLoaded", () => {
      let user = JSON.parse(localStorage.getItem("loggedInUser"));
      if (!user || user.role !== "reception") {
        alert("Access denied!");
        window.location.href = "login.html";
      }
    });
  </script>
</body>
</html>
